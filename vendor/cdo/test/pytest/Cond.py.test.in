#! @PYTHON@

from cdoTest import *

FORMAT="-f srv -b 32"
OPERATORS=["ifthen","ifnotthen"]
CONST=-77

IFILE="infile_cond"
CFILE="cfile_cond"

test_module = TestModule()
test_module.prepare(f'{CDO} {FORMAT} gtc,0 -topo,global_10 {IFILE}')
test_module.prepare(f'{CDO} {FORMAT} const,{CONST},{IFILE} {CFILE}')
for OPERATOR in OPERATORS:
    RFILE=f'{DATAPATH}/cond_{OPERATOR}c_ref'
    OFILE=f'cond_{OPERATOR}_res'
    t=TAPTest(OPERATOR)
    t.add(f'{CDO} {FORMAT} {OPERATOR} {IFILE} {CFILE} {OFILE}')
    t.add(f'{CDO} diff {OFILE} {RFILE}')
    t.clean(OFILE)
    test_module.add(t)

t.clean(IFILE,CFILE)
test_module.run()
